<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.safetyplatform.dao.RiskEnterGradeDao">
    <!--目的:为dao接口方法提供sql语句配置
    即针对dao接口中的方法编写我们的sql语句-->


    <select id="queryTest" resultType="Test">
        SELECT *
        FROM test_info
        where test_info.name=#{regionId}
    </select>

    <select id="queryAllEnterRisk" resultType="RiskEnterGrade">
select ebi.enter_id,enter_name, fatal_danger_source,high_risk_enterprise,
   danger_chemical_tech,
   restricted_space,
   dust_explosion,
   type_name as enter_industry,
   adi.text as enter_community,
   count(ehr.risk_id) as risk_num,
   ebi.dust_explosion,
   ebi.restricted_space

   from enterprise_base_info ebi,enter_business_relation ebr,business_type_info bti,admin_division_info adi,enter_hidden_relation ehr
   where ebi.enter_id = ebr.enter_id and ebr.type_id = bti.type_id and adi.region_url = ebi.gov_id and ebi.enter_id = ehr.enter_id;
    </select>


    <select id="queryEnterOtherInfoForRisk" resultType="RiskIndexA">
        SELECT cover_area,staff_num,sale_income,material_fire_danger,process_level
        FROM enterprise_other_info
        where enter_id = #{enterId};
    </select>

    <select id="queryAllEnterId" resultType="java.lang.Long">
        SELECT enter_id
        FROM enterprise_base_info;
    </select>


    <select id="queryEnterMaxAccident" resultType="int">
        SELECT max(acc_type)
        FROM enter_acc_info
        where enter_id = #{enterId}
    </select>

    <select id="queryEnterRiskNumById" resultType="int">
        SELECT count(1)
        FROM enter_hidden_relation
        where enter_id = #{enterId}
    </select>


    <select id="queryEnterFatalRiskNumById" resultType="int">
        SELECT count(1)
        FROM enter_hidden_relation
        where enter_id = #{enterId}
    </select>

    <resultMap id="getEnterHRNumResult"   type="HashMap">
        <result property="key" column="danger_level_num" />
        <result property="value" column="mynum" />

    </resultMap>

</mapper>